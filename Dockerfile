# Используем официальный образ Bun
FROM oven/bun:1.0.27-slim

# Устанавливаем рабочую директорию
WORKDIR /app

# Копируем файлы зависимостей
COPY package.json bun.lock* ./

# Устанавливаем зависимости (для продакшена)
RUN bun install

# Копируем остальные файлы проекта
COPY . .

# Экспонируем порт, который использует приложение
EXPOSE 3000

# Опционально: выполнить миграции Drizzle перед запуском
# Убедитесь, что в package.json есть скрипт для миграций
CMD ["sh", "-c", "bun run migrate && bun run start"]

# Запускаем приложение
# CMD ["bun", "run", "start"]